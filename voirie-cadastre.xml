<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE Map[
  <!ENTITY db_settings SYSTEM "config/db_settings.inc.xml">
]>
<Map srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over" background-color="transparent" minimum-version="0.7.2">



<!--remplissage polygones vus de loin -->
<Style name="admin2">
	<Rule>
		<!--moins de 5% -->
		<Filter>[avancee] &lt; 5</Filter>
		<PolygonSymbolizer fill-opacity="0.4" fill="#ec0000"/></Rule>
	<Rule>
		<Filter>[avancee] &gt; 4 and [avancee] &lt; 20</Filter>
		<PolygonSymbolizer fill-opacity="0.4" fill="#ec4800"/></Rule>
	<Rule>	
		<Filter>[avancee] &gt; 19 and [avancee] &lt; 40 </Filter>
		<PolygonSymbolizer fill-opacity="0.4" fill="#ec9600"/></Rule>
	<Rule>
		<Filter>[avancee] &gt; 39 and [avancee] &lt; 60 </Filter>
		<PolygonSymbolizer fill-opacity="0.4" fill="#ecbd00"/></Rule>
        <Rule>
		<Filter>[avancee] &gt; 59 and [avancee] &lt; 80 </Filter>
		<PolygonSymbolizer fill-opacity="0.4" fill="#9bec00"/></Rule>
         <Rule>
		<Filter>[avancee] &gt; 79  and [avancee] &lt; 101 </Filter>
                <PolygonSymbolizer fill-opacity="0.4" fill="#64ec00"/></Rule>
	<Rule>
                <Filter>[avancee] &gt; 100 and [avancee] &lt; 300</Filter>
                <PolygonSymbolizer fill-opacity="0.4" fill="#0000ff"/></Rule>
	<Rule>
		<Filter>[avancee] &gt; 300</Filter>
		<PolygonSymbolizer fill-opacity="0.9" fill="#0f0f0f"/></Rule>
	<Rule>
	        <MaxScaleDenominator>300000</MaxScaleDenominator>
	        <TextSymbolizer size="9" fill="black" dy="0" face-name="DejaVu Sans Bold" halo-radius="1" wrap-width="50">[nom]</TextSymbolizer>
	        <TextSymbolizer size="9" fill="black" dy="10" face-name="DejaVu Sans Bold" halo-radius="1" wrap-width="50">[avancee_texte]</TextSymbolizer>
        </Rule>
        
</Style>
  <Layer name="admin2" status="on" srs="+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs +over">
    <StyleName>admin2</StyleName>
    <Datasource>
	&db_settings;
      <Parameter name="table">
	      (select planet_osm_polygon.name as nom, way, km_voirie as km_osm, round(100*km_voirie/km) as avancee, 'taux:'||km_voirie||'/'||km as avancee_texte from planet_osm_polygon , cadastre where refinsee="ref:INSEE") as admin</Parameter>
      <!-- nibou <Parameter name="table">
	      (select planet_osm_polygon.name as nom, way as way, km_voirie as km_osm, round(100*km_voirie/km) as avancee, 'taux:'||km_voirie||'/'||km as avancee_texte from planet_osm_polygon , cadastre where refinsee="ref:INSEE") as admin</Parameter> -->
    </Datasource>
  </Layer>
</Map>
